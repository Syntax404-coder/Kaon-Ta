<h1>System Administration</h1>

<h2>All Reservations</h2>

<%= turbo_stream_from :reservations %>

<% if @reservations.any? %>
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Customer Name</th>
        <th>Date</th>
        <th>Time</th>
        <th>Guest Count</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="reservations">
      <%= render partial: "admin/reservations/reservation", collection: @reservations %>
    </tbody>
  </table>
<% else %>
  <p>No reservations in the system.</p>
<% end %>

<br><hr><br>

<h2>Manage Time Slots (<%= @selected_date.strftime("%B %d, %Y") %>)</h2>

<!-- Admin Date Picker -->
<div style="margin-bottom: 20px; padding: 10px; background-color: #f8f9fa; border: 1px solid #ddd; display: inline-block;">
  <form action="<%= admin_dashboard_path %>" method="get" style="display: flex; gap: 10px; align-items: center;">
    <label for="date" style="font-weight: bold;">Select Date:</label>
    <input type="date" name="date" value="<%= @selected_date %>" style="padding: 5px;">
    <input type="submit" value="Go" class="btn btn-primary btn-sm">
  </form>
</div>

<% 
  breakfast = @tables.select { |t| (7..10).include?(t.start_time.hour) }
  lunch = @tables.select { |t| (11..14).include?(t.start_time.hour) }
  dinner = @tables.select { |t| (18..21).include?(t.start_time.hour) }
%>

<% if breakfast.any? %>
  <h3>Breakfast (07:00 - 10:00)</h3>
  <table border="1" style="width:100%; text-align: left; border-collapse: collapse; margin-bottom: 20px;">
    <thead><tr><th>Time</th><th>Status</th><th>Remaining Seats</th><th>Action</th></tr></thead>
    <tbody>
      <% breakfast.each do |table| %>
        <%= render partial: "admin/dashboard/time_slot_row", locals: { table: table } %>
      <% end %>
    </tbody>
  </table>
<% end %>

<% if lunch.any? %>
  <h3>Lunch (11:00 - 14:00)</h3>
  <table border="1" style="width:100%; text-align: left; border-collapse: collapse; margin-bottom: 20px;">
    <thead><tr><th>Time</th><th>Status</th><th>Remaining Seats</th><th>Action</th></tr></thead>
    <tbody>
      <% lunch.each do |table| %>
        <%= render partial: "admin/dashboard/time_slot_row", locals: { table: table } %>
      <% end %>
    </tbody>
  </table>
<% end %>

<% if dinner.any? %>
  <h3>Dinner (18:00 - 21:00)</h3>
  <table border="1" style="width:100%; text-align: left; border-collapse: collapse; margin-bottom: 20px;">
    <thead><tr><th>Time</th><th>Status</th><th>Remaining Seats</th><th>Action</th></tr></thead>
    <tbody>
      <% dinner.each do |table| %>
        <%= render partial: "admin/dashboard/time_slot_row", locals: { table: table } %>
      <% end %>
    </tbody>
  </table>
<% end %>

